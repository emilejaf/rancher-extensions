{"version":3,"sources":["webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue?0e5d","webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue?7ab7","webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue?2ba1","webpack://node-driver-0.1.1/./components/BusyButton.vue?bee5","webpack://node-driver-0.1.1/./components/BusyButton.vue?2e07","webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue","webpack://node-driver-0.1.1//Users/emile/vr/viarezo-node-driver/node_modules/@rancher/shell/utils/url.ts","webpack://node-driver-0.1.1/./components/BusyButton.vue","webpack://node-driver-0.1.1/components/BusyButton.vue","webpack://node-driver-0.1.1/./components/BusyButton.vue?9ea3","webpack://node-driver-0.1.1/./components/BusyButton.vue?62a2","webpack://node-driver-0.1.1/cloud-credential/viarezo.vue","webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue?a653","webpack://node-driver-0.1.1/./cloud-credential/viarezo.vue?c7e7","webpack://node-driver-0.1.1/./components/BusyButton.vue?5f16","webpack://node-driver-0.1.1/./openstack.ts"],"names":["content","__esModule","default","module","i","locals","exports","add","___CSS_LOADER_API_IMPORT___","push","render","_vm","this","_c","_self","staticClass","attrs","value","decodedData","endpoint","step","mode","on","$event","setData","domainName","username","password","ref","canAuthenticate","connect","busy","clear","_v","_s","t","error","_e","errorAllowHost","hostname","allowBusy","addHostToAllowList","projects","project","projectOptions","newValue","regions","region","regionOptions","newRegion","staticRenderFns","parse","str","o","options","m","parser","strictMode","exec","Error","uri","key","query","queryStr","replace","q","_","$1","$2","name","strict","loose","disabled","tabIndex","componentTestid","clicked","displayLabel","props","label","type","String","undefined","labelKey","Boolean","Number","manual","data","computed","$store","getters","methods","stopPropagation","preventDefault","cb","$emit","focus","$refs","btn","component","components","Banner","BusyButton","LabeledInput","LabeledSelect","required","Object","driver","dispatch","id","_CREATE","annotations","sorted","sort","a","b","localeCompare","map","p","u","parseUrl","host","_this$value","_this$value2","_this$value3","_this$value4","created","test","find","hostInAllowList","_this$driver","_this$driver2","whitelistDomains","includes","save","$el","click","e","console","_this$projectOptions$","_this$regionOptions$","okay","os","Openstack","res","getToken","_status","message","getProjects","getRegions","prj","osRegions","projectName","projectId","projectDomainName","domain_id","then","regionsFromCatalog","constructor","obj","_defineProperty","keys","forEach","split","length","field","$dispatch","baseUrl","url","auth","identity","user","domain","scope","headers","Accept","_res$token","_res$token2","method","redirectUnauthorized","root","token","_headers","userId","domainId","catalog","endpoints","service","iface","svc","interface","region_id","initial","getOptions","v","keypair","network","zone","zoneName","api","mapper","enabled","selected","makeComputeRequest","list","k","convertToOptions","found","option"],"mappings":"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","file":"node-driver-0.1.1.umd.min.cloud-credential.js","sourcesContent":["export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viarezo.vue?vue&type=style&index=0&id=12789930&prod&lang=scss&scoped=true\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viarezo.vue?vue&type=style&index=0&id=12789930&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"46ece8a7\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".allow-list-error[data-v-12789930]{display:flex}.allow-list-error[data-v-12789930]>:first-child{flex:1}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".icon-spacer[data-v-057271d0]{width:24px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=style&index=0&id=057271d0&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1d62ab36\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{attrs:{\"value\":_vm.value.decodedData.endpoint,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.viarezo.auth.fields.endpoint\",\"placeholder-key\":\"driver.viarezo.auth.placeholders.endpoint\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('endpoint', $event)}}})],1),_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{attrs:{\"value\":_vm.value.decodedData.domainName,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.viarezo.auth.fields.domainName\",\"placeholder-key\":\"driver.viarezo.auth.placeholders.domainName\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('domainName', $event);}}})],1)]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{staticClass:\"mt-20\",attrs:{\"value\":_vm.value.decodedData.username,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.viarezo.auth.fields.username\",\"placeholder-key\":\"driver.viarezo.auth.placeholders.username\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('username', $event);}}})],1),_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{staticClass:\"mt-20\",attrs:{\"value\":_vm.value.decodedData.password,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.viarezo.auth.fields.password\",\"placeholder-key\":\"driver.viarezo.auth.placeholders.password\",\"type\":\"password\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('password', $event);}}})],1)]),_c('BusyButton',{ref:\"connect\",staticClass:\"mt-20\",attrs:{\"label-key\":\"driver.viarezo.auth.actions.authenticate\",\"disabled\":_vm.step !== 1 || !_vm.canAuthenticate},on:{\"click\":_vm.connect}}),_c('button',{staticClass:\"btn role-primary mt-20 ml-20\",attrs:{\"disabled\":_vm.busy || _vm.step === 1},on:{\"click\":_vm.clear}},[_vm._v(\" \"+_vm._s(_vm.t('driver.viarezo.auth.actions.edit'))+\" \")]),(_vm.error)?_c('Banner',{staticClass:\"mt-20\",attrs:{\"color\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),(_vm.errorAllowHost)?_c('Banner',{staticClass:\"allow-list-error\",attrs:{\"color\":\"error\"}},[_c('div',[_vm._v(\" \"+_vm._s(_vm.t('driver.viarezo.auth.errors.notAllowed', { hostname: _vm.hostname }))+\" \")]),_c('button',{staticClass:\"btn ml-10 role-primary\",attrs:{\"disabled\":_vm.allowBusy},on:{\"click\":_vm.addHostToAllowList}},[_vm._v(\" \"+_vm._s(_vm.t('driver.viarezo.auth.actions.addToAllowList'))+\" \")])]):_vm._e(),(_vm.projects)?_c('div',{staticClass:\"row mt-20\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledSelect',{attrs:{\"value\":_vm.project,\"label-key\":\"driver.viarezo.auth.fields.project\",\"options\":_vm.projectOptions,\"searchable\":false},on:{\"update:value\":newValue => _vm.project = newValue}})],1),(_vm.regions)?_c('div',{staticClass:\"col span-6\"},[_c('LabeledSelect',{attrs:{\"value\":_vm.region,\"label-key\":\"driver.viarezo.auth.fields.region\",\"options\":_vm.regionOptions,\"searchable\":false},on:{\"update:value\":newRegion => _vm.region = newRegion}})],1):_vm._e()]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","type UriField = 'source' | 'protocol' | 'authority' | 'userInfo' | 'user' | 'password' | 'host' | 'port' | 'relative' | 'path' | 'directory' | 'file' | 'queryStr' | 'anchor'\ntype UriFields = {\n  [key in UriField]: string; // eslint-disable-line no-unused-vars\n}\nexport type QueryParams = {\n  [key: string]: string\n}\n\ninterface ParsedUri extends UriFields {\n  query: QueryParams;\n}\n\nexport function addParam(url: string, key: string, val: string | string[]): string {\n  let out = url + (url.includes('?') ? '&' : '?');\n\n  // val can be a string or an array of strings\n  if ( !Array.isArray(val) ) {\n    val = [val];\n  }\n  out += val.map((v) => {\n    if ( v === null ) {\n      return `${ encodeURIComponent(key) }`;\n    } else {\n      return `${ encodeURIComponent(key) }=${ encodeURIComponent(v) }`;\n    }\n  }).join('&');\n\n  return out;\n}\n\nexport function addParams(url: string, params: QueryParams): string {\n  if ( params && typeof params === 'object' ) {\n    Object.keys(params).forEach((key) => {\n      url = addParam(url, key, params[key]);\n    });\n  }\n\n  return url;\n}\n\nexport function removeParam(url: string, key: string): string {\n  const parsed = parse(url);\n\n  if ( parsed.query?.[key] ) {\n    delete parsed.query[key];\n  }\n\n  return stringify(parsed);\n}\n\nexport function parseLinkHeader(str: string): Record<string, string> {\n  const out: { [key: string]: string} = { };\n  const lines = (str || '').split(',');\n\n  for ( const line of lines ) {\n    const match = line.match(/^\\s*<([^>]+)>\\s*;\\s*rel\\s*=\"(.*)\"/);\n\n    if ( match ) {\n      out[match[2].toLowerCase()] = match[1];\n    }\n  }\n\n  return out;\n}\n\nexport function isMaybeSecure(port: number, proto: string): boolean {\n  const protocol = proto.toLowerCase();\n\n  return portMatch([port], [443, 8443], ['443']) || protocol === 'https';\n}\n\nexport function portMatch(ports: number[], equals: number[], endsWith: string[]): boolean {\n  for (let i = 0; i < ports.length; i++) {\n    const port = ports[i];\n\n    if (equals.includes(port)) {\n      return true;\n    }\n\n    for (let j = 0; j < endsWith.length; j++) {\n      const suffix = `${ endsWith[j] }`;\n      const portStr = `${ port }`;\n\n      if (portStr !== suffix && portStr.endsWith(suffix)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// parseUri 1.2.2\n// (c) Steven Levithan <stevenlevithan.com>\n// https://javascriptsource.com/parseuri/\n// MIT License\nexport function parse(str: string): ParsedUri {\n  const o = parse.options;\n  const m = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str);\n\n  if (!m) {\n    throw new Error(`Cannot parse as uri: ${ str }`);\n  }\n  const uri = {} as ParsedUri;\n  let i = 14;\n\n  while (i--) {\n    uri[o.key[i]] = m[i] || '';\n  }\n\n  uri.query = {};\n  uri.queryStr.replace(o.q.parser, (_, $1: string, $2: string): string => {\n    if ($1) {\n      uri[o.q.name][$1] = $2;\n    }\n\n    return '';\n  });\n\n  return uri;\n}\n\nparse.options = {\n  strictMode: false,\n  key:        ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'queryStr', 'anchor'],\n  q:          {\n    name:   'query',\n    parser: /(?:^|&)([^&=]*)=?([^&]*)/g\n  },\n  parser: {\n    strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\n    loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\n  }\n} as {\n  strictMode: boolean,\n  key: UriField[],\n  q: {\n    name: 'query',\n    parser: RegExp\n  },\n  parser: {\n    strict: RegExp,\n    loose: RegExp\n  }\n};\n\nexport function stringify(uri: ParsedUri): string {\n  let out = `${ uri.protocol }://`;\n\n  if ( uri.user && uri.password ) {\n    out += `${ uri.user }:${ uri.password }@`;\n  } else if ( uri.user ) {\n    out += `${ uri.user }@`;\n  }\n\n  out += uri.host;\n\n  if ( uri.port ) {\n    out += `:${ uri.port }`;\n  }\n\n  out += uri.path || '/';\n\n  out = addParams(out, uri.query || {});\n\n  if ( uri.anchor ) {\n    out += `#${ uri.anchor }`;\n  }\n\n  return out;\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('button',{ref:\"btn\",staticClass:\"btn role-primary\",attrs:{\"disabled\":_vm.disabled,\"tab-index\":_vm.tabIndex,\"data-testid\":_vm.componentTestid + '-async-button'},on:{\"click\":_vm.clicked}},[(_vm.busy)?_c('i',{staticClass:\"icon icon-lg icon-spinner icon-spin\"}):_c('span',{staticClass:\"icon-spacer\"}),_c('span',[_vm._v(_vm._s(_vm.displayLabel))]),_c('span',{staticClass:\"icon-spacer\"})])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nexport default {\n  props: {\n    /**\n     * Mode maps to keys in asyncButton.* translations\n     */\n    label: {\n      type: String,\n      default: undefined,\n    },\n    labelKey: {\n      type: String,\n      default: undefined,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    tabIndex: {\n      type: Number,\n      default: null,\n    },\n\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type: String,\n      default: 'busy-button'\n    },\n\n    manual: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  data() {\n    return { busy: false };\n  },\n\n  computed: {\n    displayLabel() {\n      if (this.labelKey) {\n        const t = this.$store.getters['i18n/t'];\n\n        return t(this.labelKey);\n      }\n\n      return this.label;\n    }\n  },\n\n  methods: {\n    clicked($event) {\n      if ($event) {\n        $event.stopPropagation();\n        $event.preventDefault();\n      }\n\n      if (this.disabled) {\n        return;\n      }\n\n      const cb = () => {\n        this.busy = false;\n      };\n\n      this.busy = true;\n\n      this.$emit('click', cb);\n    },\n\n    focus() {\n      (this.$refs.btn).focus();\n    }\n  }\n};\n</script>\n\n<template>\n  <button ref=\"btn\" class=\"btn role-primary\" :disabled=\"disabled\" :tab-index=\"tabIndex\"\n    :data-testid=\"componentTestid + '-async-button'\" @click=\"clicked\">\n    <i v-if=\"busy\" class=\"icon icon-lg icon-spinner icon-spin\" />\n    <span v-else class=\"icon-spacer\" />\n    <span>{{ displayLabel }}</span>\n    <span class=\"icon-spacer\" />\n  </button>\n</template>\n<style lang=\"scss\" scoped>\n.icon-spacer {\n  width: 24px;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./BusyButton.vue?vue&type=template&id=057271d0&scoped=true\"\nimport script from \"./BusyButton.vue?vue&type=script&lang=js\"\nexport * from \"./BusyButton.vue?vue&type=script&lang=js\"\nimport style0 from \"./BusyButton.vue?vue&type=style&index=0&id=057271d0&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"057271d0\",\n  null\n  \n)\n\nexport default component.exports","<script>\nimport Banner from '@components/Banner/Banner.vue';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { NORMAN, MANAGEMENT } from '@shell/config/types';\nimport { parse as parseUrl } from '@shell/utils/url';\nimport { _CREATE } from '@shell/config/query-params';\nimport BusyButton from '../components/BusyButton.vue';\nimport { Openstack } from '../openstack';\n\nexport default {\n  components: {\n    Banner,\n    BusyButton,\n    LabeledInput,\n    LabeledSelect,\n  },\n\n  props: {\n    mode: {\n      type: String,\n      required: true,\n    },\n\n    value: {\n      type: Object,\n      required: true,\n    },\n  },\n\n  async fetch() {\n    this.driver = await this.$store.dispatch('rancher/find', {\n      type: 'nodedriver',\n      id: 'viarezo'\n    });\n  },\n\n  data() {\n\n    if (this.mode !== _CREATE) {\n      this.value.decodedData.username = this.value.annotations['viarezo.cattle.io/username'];\n      this.value.decodedData.endpoint = this.value.annotations['viarezo.cattle.io/endpoint'];\n    }\n\n    return {\n      projects: null,\n      regions: null,\n      step: 1,\n      busy: false,\n      project: '',\n      region: '',\n      errorAllowHost: false,\n      driver: {},\n      allowBusy: false,\n      error: '',\n    };\n  },\n\n  computed: {\n    projectOptions() {\n      const sorted = (this.projects || []).sort((a, b) => a.name.localeCompare(b.name));\n\n      return sorted.map((p) => {\n        return {\n          label: p.name,\n          value: p.id\n        };\n      });\n    },\n\n    regionOptions() {\n      const sorted = (this.regions || []).sort((a, b) => a.name.localeCompare(b.name));\n\n      return sorted.map((p) => {\n        return {\n          label: p.id,\n          value: p.id\n        };\n      });\n    },\n\n    hostname() {\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      return u?.host || '';\n    },\n\n    canAuthenticate() {\n      return !!this.value?.decodedData?.endpoint &&\n        !!this.value?.decodedData?.domainName &&\n        !!this.value?.decodedData?.username &&\n        !!this.value?.decodedData?.password;\n    }\n  },\n\n  created() {\n    this.$emit('validationChanged', false);\n  },\n\n  methods: {\n    // TODO: Validate that we can get a token for the project that the user has selected\n    test() {\n      // In the cluster creation flow, annotations is not set, so ensure it is set first\n      this.value.annotations = this.value.annotations || {};\n\n      this.value.annotations['viarezo.cattle.io/username'] = this.value.decodedData.username;\n      this.value.annotations['viarezo.cattle.io/domainName'] = this.value.decodedData.domainName;\n      this.value.annotations['viarezo.cattle.io/endpoint'] = this.value.decodedData.endpoint;\n\n      const project = this.projects.find(p => p.id === this.project);\n\n      if (project) {\n        this.value.annotations['viarezo.cattle.io/projectId'] = project.id;\n      }\n\n      if (this.region) {\n        this.value.annotations['viarezo.cattle.io/region'] = this.region;\n      }\n\n      return true;\n    },\n\n    // When the user clicked 'Edit Auth Config', clear the projects and set the step back to 1\n    // so the user can modify the credentials needed to fetch the projects\n    clear() {\n\n      this.step = 1;\n      this.projects = null;\n      this.errorAllowHost = false;\n\n      // Tell parent that the form is not invalid\n      this.$emit('validationChanged', false);\n    },\n\n    hostInAllowList() {\n      if (!this.driver?.whitelistDomains) {\n        return false;\n      }\n\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      if (!u.host) {\n        return true;\n      }\n\n      return (this.driver?.whitelistDomains || []).includes(u.host);\n    },\n\n    async addHostToAllowList() {\n      this.allowBusy = true;\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      this.driver.whitelistDomains = this.driver.whitelistDomains || [];\n\n      if (!this.hostInAllowList()) {\n        this.driver.whitelistDomains.push(u.host);\n      }\n\n      try {\n        await this.driver.save();\n\n        this.$refs.connect.$el.click();\n      } catch (e) {\n        console.error('Could not update driver', e); // eslint-disable-line no-console\n        this.allowBusy = false;\n      }\n    },\n\n    async connect(cb) {\n\n      if (cb && typeof cb !== 'function') {\n        return;\n      }\n\n\n      this.error = '';\n      this.errorAllowHost = false;\n\n      let okay = false;\n\n      if (!this.value.decodedData.endpoint) {\n        return cb(okay);\n      }\n\n      const os = new Openstack(this.$store, {\n        endpoint: this.value.decodedData.endpoint,\n        domainName: this.value.decodedData.domainName,\n        username: this.value.decodedData.username,\n        password: this.value.decodedData.password,\n      });\n\n      this.allowBusy = false;\n      this.step = 2;\n      this.busy = true;\n\n      const res = await os.getToken();\n\n      if (res.error) {\n        console.error(res.error); // eslint-disable-line no-console\n        okay = false;\n\n        this.step = 1;\n        this.projects = null;\n\n        if (res.error._status === 502 && !this.hostInAllowList()) {\n          this.errorAllowHost = true;\n        } else {\n          if (res.error._status === 502) {\n            // Still got 502, even with URL in the allow list\n            this.error = this.t('driver.viarezo.auth.errors.badGateway');\n          } else if (res.error._status === 401) {\n            this.error = this.t('driver.viarezo.auth.errors.unauthorized');\n          } else {\n            // Generic error\n            this.error = res.error.message || this.t('driver.viarezo.auth.errors.other');\n          }\n        }\n      } else {\n        const projects = await os.getProjects();\n\n        if (!projects.error) {\n          this.projects = projects;\n          okay = true;\n        } else {\n          this.error = projects.error.message;\n        }\n\n        const regions = await os.getRegions();\n\n        if (!regions.error) {\n          this.regions = regions;\n          okay = true;\n        } else {\n          // Could not list regions, so infer them from the project\n          const prj = this.projectOptions[0].value;\n          const project = this.projects.find(p => p.id === prj);\n\n          if (project) {\n            const osRegions = new Openstack(this.$store, {\n              ...os,\n              projectName: project.name,\n              projectId: project.id,\n              projectDomainName: project.domain_id\n            });\n\n            // Fetch a token with the project, so we get the endpoint catalog\n            await osRegions.getToken().then(() => {\n              this.regions = osRegions.regionsFromCatalog;\n            });\n          }\n\n          // this.$set(this, 'error', regions.error.message || this.t('driver.openstack.auth.errors.regions'));\n        }\n      }\n      this.busy = false;\n      this.project = this.projectOptions[0]?.value;\n      this.region = this.regionOptions[0]?.value;\n\n      this.$emit('validationChanged', okay);\n\n      cb(okay);\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledInput :value=\"value.decodedData.endpoint\" :disabled=\"step !== 1\"\n          label-key=\"driver.viarezo.auth.fields.endpoint\" placeholder-key=\"driver.viarezo.auth.placeholders.endpoint\"\n          type=\"text\" :mode=\"mode\" @input=\"value.setData('endpoint', $event)\" />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput :value=\"value.decodedData.domainName\" :disabled=\"step !== 1\"\n          label-key=\"driver.viarezo.auth.fields.domainName\"\n          placeholder-key=\"driver.viarezo.auth.placeholders.domainName\" type=\"text\" :mode=\"mode\"\n          @input=\"value.setData('domainName', $event);\" />\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledInput :value=\"value.decodedData.username\" :disabled=\"step !== 1\" class=\"mt-20\"\n          label-key=\"driver.viarezo.auth.fields.username\" placeholder-key=\"driver.viarezo.auth.placeholders.username\"\n          type=\"text\" :mode=\"mode\" @input=\"value.setData('username', $event);\" />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput :value=\"value.decodedData.password\" :disabled=\"step !== 1\" class=\"mt-20\"\n          label-key=\"driver.viarezo.auth.fields.password\" placeholder-key=\"driver.viarezo.auth.placeholders.password\"\n          type=\"password\" :mode=\"mode\" @input=\"value.setData('password', $event);\" />\n      </div>\n    </div>\n\n    <BusyButton ref=\"connect\" label-key=\"driver.viarezo.auth.actions.authenticate\"\n      :disabled=\"step !== 1 || !canAuthenticate\" class=\"mt-20\" @click=\"connect\" />\n\n    <button class=\"btn role-primary mt-20 ml-20\" :disabled=\"busy || step === 1\" @click=\"clear\">\n      {{ t('driver.viarezo.auth.actions.edit') }}\n    </button>\n\n    <Banner v-if=\"error\" class=\"mt-20\" color=\"error\">\n      {{ error }}\n    </Banner>\n\n    <Banner v-if=\"errorAllowHost\" color=\"error\" class=\"allow-list-error\">\n      <div>\n        {{ t('driver.viarezo.auth.errors.notAllowed', { hostname }) }}\n      </div>\n      <button :disabled=\"allowBusy\" class=\"btn ml-10 role-primary\" @click=\"addHostToAllowList\">\n        {{ t('driver.viarezo.auth.actions.addToAllowList') }}\n      </button>\n    </Banner>\n    <div v-if=\"projects\" class=\"row mt-20\">\n      <div class=\"col span-6\">\n        <LabeledSelect :value=\"project\" @update:value=\"newValue => project = newValue\"\n          label-key=\"driver.viarezo.auth.fields.project\" :options=\"projectOptions\" :searchable=\"false\" />\n      </div>\n      <div v-if=\"regions\" class=\"col span-6\">\n        <LabeledSelect :value=\"region\" @update:value=\"newRegion => region = newRegion\"\n          label-key=\"driver.viarezo.auth.fields.region\" :options=\"regionOptions\" :searchable=\"false\" />\n      </div>\n    </div>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n.allow-list-error {\n  display: flex;\n\n  > :first-child {\n    flex: 1;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viarezo.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viarezo.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./viarezo.vue?vue&type=template&id=12789930&scoped=true\"\nimport script from \"./viarezo.vue?vue&type=script&lang=js\"\nexport * from \"./viarezo.vue?vue&type=script&lang=js\"\nimport style0 from \"./viarezo.vue?vue&type=style&index=0&id=12789930&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"12789930\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=style&index=0&id=057271d0&prod&lang=scss&scoped=true\"","/**\n * Helper class for dealing with the Openstack API\n *\n * Openstack API Docs:\n *\n *  https://docs.openstack.org/api-ref/compute/index.html\n *\n */\nexport class Openstack {\n  public domainId: string = \"\";\n  public domainName: string = \"\";\n  public endpoint: string = \"\";\n  public projectDomainName: string = \"\";\n  public projectId: string = \"\";\n  public username: string = \"\";\n  public password: string = \"\";\n  public token: string = \"\";\n  public region: string = \"\";\n  private catalog: any;\n  private endpoints: any;\n  private userId: string = \"\";\n\n  private $dispatch: any;\n\n  public regionsFromCatalog: any[] = [];\n\n  constructor($store: any, obj: any) {\n    if (obj.annotations) {\n      Object.keys(obj.annotations).forEach((key) => {\n        const p = key.split(\"/\");\n\n        if (p.length === 2 && p[0] === \"viarezo.cattle.io\") {\n          const field = p[1];\n\n          (this as any)[field] = obj.annotations[key];\n        }\n      });\n    } else {\n      // Copy from options to this\n      Object.keys(obj).forEach((key) => {\n        (this as any)[key] = obj[key];\n      });\n    }\n\n    this.$dispatch = $store.dispatch;\n  }\n\n  public async getToken() {\n    const endpoint = this.endpoint.replace(/^https?:\\/\\//, \"\");\n    const baseUrl = `/meta/proxy/${endpoint}`;\n    const url = `${baseUrl}/auth/tokens`;\n\n    const data = {\n      auth: {\n        identity: {\n          methods: [\"password\"],\n          password: {\n            user: {\n              name: this.username,\n              domain: { name: this.domainName },\n              password: this.password,\n            },\n          },\n        },\n      },\n    };\n\n    if (this.projectId) {\n      (data as any).auth.scope = {\n        project: {\n          id: this.projectId,\n        },\n      };\n    }\n\n    const headers = { Accept: \"application/json\" };\n\n    try {\n      const res = await this.$dispatch(\n        \"management/request\",\n        {\n          url,\n          headers,\n          method: \"POST\",\n          redirectUnauthorized: false,\n          data,\n        },\n        { root: true }\n      );\n\n      if (res._status === 502) {\n        return {\n          error:\n            \"Could not proxy request - URL may not be in Rancher's allow list\",\n        };\n      }\n\n      const token = res._headers[\"x-subject-token\"];\n\n      this.token = token;\n\n      this.userId = res?.token?.user?.id;\n\n      this.domainId = res?.token?.project?.domain?.id;\n\n      this.regionsFromCatalog = [];\n\n      if ((data as any).auth.scope && res?.token) {\n        this.catalog = res.token.catalog;\n        this.endpoints = {};\n        this.catalog.forEach((service: any) => {\n          const iface = service.endpoints.find(\n            (svc: any) => svc.interface === \"public\"\n          );\n\n          // Only use the interfaces for the region\n          if (iface && iface.region_id === this.region) {\n            this.endpoints[service.type] = iface.url;\n          }\n\n          if (iface && service.type === \"compute\") {\n            if (!this.regionsFromCatalog.includes(iface.region_id)) {\n              this.regionsFromCatalog.push(iface.region_id);\n            }\n          }\n        });\n      }\n\n      this.regionsFromCatalog = this.regionsFromCatalog.map((id) => {\n        return { id };\n      });\n\n      return res;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n\n      return { error: e };\n    }\n  }\n\n  public async getFlavors(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/flavors\",\n      \"flavors\",\n      undefined,\n      initial\n    );\n  }\n\n  public async getImages(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/images/detail\",\n      \"images\",\n      undefined,\n      initial\n    );\n  }\n\n  public async getKeyPairs(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/os-keypairs\",\n      \"keypairs\",\n      (v: any) => v.keypair,\n      initial\n    );\n  }\n\n  public async getSecurityGroups(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/os-security-groups\",\n      \"security_groups\",\n      undefined,\n      initial\n    );\n  }\n\n  public async getFloatingIpPools(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/os-floating-ip-pools\",\n      \"floating_ip_pools\",\n      undefined,\n      initial\n    );\n  }\n\n  public async getNetworkNames(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/os-tenant-networks\",\n      \"networks\",\n      (network: any) => {\n        return {\n          ...network,\n          name: network.label,\n        };\n      },\n      initial\n    );\n  }\n\n  public async getAvailabilityZones(value: any, initial?: string) {\n    return await this.getOptions(\n      value,\n      \"/os-availability-zone\",\n      \"availabilityZoneInfo\",\n      (zone: any) => {\n        return {\n          ...zone,\n          name: zone.zoneName,\n        };\n      },\n      initial\n    );\n  }\n\n  public async getOptions(\n    value: any,\n    api: string,\n    field: string,\n    mapper?: Function,\n    initial?: string\n  ) {\n    // We are fetching the data for the options\n    value.busy = true;\n    value.enabled = true;\n    value.selected = \"\";\n\n    const res = await this.makeComputeRequest(api);\n\n    if (res && (res as any)[field]) {\n      let list = (res as any)[field] || [];\n\n      if (mapper) {\n        list = list.map((k: any) => mapper(k));\n      }\n\n      value.options = this.convertToOptions(list);\n      value.busy = false;\n\n      if (initial) {\n        const found = value.options.find(\n          (option: any) => option.value.id === initial\n        );\n\n        if (found) {\n          value.selected = found.value;\n        }\n      }\n\n      if (!value.selected && value.options.length > 0) {\n        value.selected = value.options[0].value;\n      }\n    } else {\n      value.options = [];\n      value.selected = null;\n      value.busy = false;\n      value.enabled = false;\n    }\n  }\n\n  public async makeComputeRequest(api: string) {\n    const endpoint = this.endpoints[\"compute\"].replace(/^https?:\\/\\//, \"\");\n    const baseUrl = `/meta/proxy/${endpoint}`;\n    const url = `${baseUrl}${api}`;\n\n    const headers = {\n      Accept: \"application/json\",\n      \"X-Auth-Token\": this.token,\n    };\n\n    try {\n      const res = await this.$dispatch(\n        \"management/request\",\n        {\n          url,\n          headers,\n          method: \"GET\",\n          redirectUnauthorized: false,\n        },\n        { root: true }\n      );\n\n      return res;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n    }\n  }\n\n  public async getProjects() {\n    const endpoint = this.endpoint.replace(/^https?:\\/\\//, \"\");\n    const baseUrl = `/meta/proxy/${endpoint}`;\n\n    const headers = {\n      Accept: \"application/json\",\n      \"X-Auth-Token\": this.token,\n    };\n\n    try {\n      const res = await this.$dispatch(\n        \"management/request\",\n        {\n          url: `${baseUrl}/users/${this.userId}/projects`,\n          headers,\n          method: \"GET\",\n          redirectUnauthorized: false,\n        },\n        { root: true }\n      );\n\n      return res?.projects;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n\n      return { error: e };\n    }\n  }\n\n  public async getRegions() {\n    const endpoint = this.endpoint.replace(/^https?:\\/\\//, \"\");\n    const baseUrl = `/meta/proxy/${endpoint}`;\n\n    const headers = {\n      Accept: \"application/json\",\n      \"X-Auth-Token\": this.token,\n    };\n\n    try {\n      const res = await this.$dispatch(\n        \"management/request\",\n        {\n          url: `${baseUrl}/regions`,\n          headers,\n          method: \"GET\",\n          redirectUnauthorized: false,\n        },\n        { root: true }\n      );\n\n      return res?.regions;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n\n      return { error: e };\n    }\n  }\n\n  private convertToOptions(list: any) {\n    const sorted = (list || []).sort((a: any, b: any) =>\n      a.name.localeCompare(b.name)\n    );\n\n    return sorted.map((p: any) => {\n      return {\n        label: p.name,\n        value: p,\n      };\n    });\n  }\n}\n"],"sourceRoot":""}